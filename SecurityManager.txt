package progetto.helper;

import java.time.Instant;
import java.time.LocalDateTime;
import java.time.OffsetDateTime;
import java.util.Base64;

public class SecurityManager {

    public static String encode(String toEncode) {
        if (toEncode == null) {
            throw new IllegalArgumentException("Input string to encode cannot be null.");
        }
        return Base64.getEncoder().encodeToString(toEncode.getBytes());
    }

    public static String decode(String toDecode) {
        if (toDecode == null) {
            throw new IllegalArgumentException("Input string to decode cannot be null.");
        }
        return new String(Base64.getDecoder().decode(toDecode));
    }

    public static String generateToken(String mail) {
        if (mail == null) {
            throw new IllegalArgumentException("Email address cannot be null.");
        }

        LocalDateTime now = LocalDateTime.now();
        Instant instant = now.toInstant(OffsetDateTime.now().getOffset());
        long timestamp = instant.getEpochSecond() * 1000;

        return encode(mail) + "_" + timestamp;
    }
}
